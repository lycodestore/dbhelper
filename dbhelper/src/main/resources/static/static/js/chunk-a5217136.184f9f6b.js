(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-a5217136"],{"0ec3":function(e,t,a){"use strict";var n=a("782c"),r=a.n(n);r.a},1230:function(e,t,a){"use strict";var n=a("1923"),r=a.n(n);r.a},1923:function(e,t,a){},"2a66":function(e,t,a){"use strict";var n=a("7f22"),r=a.n(n);r.a},"782c":function(e,t,a){},"7f22":function(e,t,a){},dc47:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content-wrapper"},[a("el-card",{attrs:{shadow:"always"}},[a("el-card",{attrs:{shadow:"always"}},[a("div",{staticStyle:{overflow:"hidden"},attrs:{slot:"header"},slot:"header"},[a("span",[e._v(e._s(e.tablename))]),e._v(" "),a("el-button",{staticStyle:{float:"right"},attrs:{type:"primary"},on:{click:e.showSql}},[e._v("\n          查看sql\n        ")])],1),e._v(" "),a("el-table",{attrs:{data:e.structure,border:""}},[a("el-table-column",{attrs:{prop:"Field",label:"Field",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"Type",label:"Type",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"Key",label:"Key",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"Default",label:"Default",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"Extra",label:"Extra",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"Privileges",label:"Privileges",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"Comment",label:"Comment",align:"center"}})],1)],1),e._v(" "),a("el-card",{staticStyle:{"margin-top":"20px"},attrs:{shadow:"always"}},[a("div",{staticStyle:{overflow:"hidden"},attrs:{slot:"header"},slot:"header"},[a("span",[e._v("数据")]),e._v(" "),a("el-button",{staticStyle:{float:"right"},attrs:{type:"primary",size:"small",loading:e.downloadLoading,icon:"document"},on:{click:e.downloadToExcel}},[e._v("\n          下载所有数据到excel\n        ")]),e._v(" "),a("el-button",{staticStyle:{float:"right","margin-right":"20px"},attrs:{type:"primary",size:"small"},on:{click:e.insertRecord}},[e._v("\n          新增数据\n        ")])],1),e._v(" "),a("el-table",{attrs:{data:e.tableData,border:""}},[e._l(e.header,function(e,t){return a("el-table-column",{key:t,attrs:{prop:e,label:e,align:"center"}})}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"150",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",size:"small",plain:""},on:{click:function(a){return e.handleEdit(t.row)}}},[e._v("修改")]),e._v(" "),a("el-button",{attrs:{type:"danger",size:"small",plain:""},on:{click:function(a){return e.handleDelete(t.row)}}},[e._v("删除")])]}}])})],2),e._v(" "),a("div",{staticStyle:{"margin-top":"10px","text-align":"center"}},[a("el-pagination",{attrs:{background:"",layout:"prev, pager, next",total:e.total},on:{"current-change":e.changePage}})],1)],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"新增记录",visible:e.showInsertFrame,center:"","close-on-click-modal":!1},on:{"update:visible":function(t){e.showInsertFrame=t}}},[a("insert-frame",{attrs:{header:e.header},on:{confirmInsert:e.submitInsert}})],1),e._v(" "),e.showEditFrame?a("el-dialog",{attrs:{title:"修改记录",visible:e.showEditFrame,center:"","close-on-click-modal":!1},on:{"update:visible":function(t){e.showEditFrame=t}}},[a("edit-frame",{attrs:{header:e.header,"old-record":e.currentRecord},on:{confirmModify:e.submitModify}})],1):e._e(),e._v(" "),a("el-dialog",{attrs:{title:"建表语句",visible:e.showSqlFrame,center:"","close-on-click-modal":!1},on:{"update:visible":function(t){e.showSqlFrame=t}}},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.sql,expression:"sql"}],staticClass:"sql-frame",attrs:{spellcheck:"false",autocapitalize:"off",autocomplete:"off",autocorrect:"off",cols:"30",rows:"10"},domProps:{value:e.sql},on:{input:function(t){t.target.composing||(e.sql=t.target.value)}}})])],1)},r=[],o=(a("7364"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-table",{attrs:{border:"",data:e.tableData}},[e._l(e.header,function(t,n){return a("el-table-column",{key:n,attrs:{align:"center",label:t},scopedSlots:e._u([{key:"default",fn:function(n){return[a("el-input",{model:{value:n.row[t],callback:function(a){e.$set(n.row,t,a)},expression:"scope.row[item]"}})]}}],null,!0)})}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"danger",size:"small",plain:""},on:{click:function(a){return e.deleteRow(t.row.index)}}},[e._v("删除")])]}}])})],2),e._v(" "),a("div",{staticStyle:{"margin-top":"20px"}},[a("i",{staticClass:"el-icon-circle-plus add-column",on:{click:e.newRow}})]),e._v(" "),a("div",{staticStyle:{"text-align":"center"}},[a("el-button",{attrs:{type:"primary"},on:{click:e.confirmAdd}},[e._v("确认新增")])],1)],1)}),l=[],c=(a("f763"),{props:{header:{type:Array,default:function(){return[]}}},data:function(){return{tableData:[],currentIndex:0}},methods:{newRow:function(){var e={};this.header.forEach(function(t){e[t]=null}),e.index=this.currentIndex,this.currentIndex++,this.tableData.push(e)},deleteRow:function(e){var t=this;this.tableData.forEach(function(a){if(a.index===e){var n=t.tableData.indexOf(a);t.tableData.splice(n,1)}})},confirmAdd:function(){this.$emit("confirmInsert",this.tableData)}}}),s=c,i=(a("0ec3"),a("17cc")),u=Object(i["a"])(s,o,l,!1,null,"7c0d04e7",null),d=u.exports,h=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-table",{attrs:{border:"",data:e.tableData}},e._l(e.header,function(t,n){return a("el-table-column",{key:n,attrs:{align:"center",label:t},scopedSlots:e._u([{key:"default",fn:function(n){return[a("el-input",{model:{value:n.row[t],callback:function(a){e.$set(n.row,t,a)},expression:"scope.row[item]"}})]}}],null,!0)})}),1),e._v(" "),a("div",{staticStyle:{"text-align":"center","margin-top":"20px"}},[a("el-button",{attrs:{type:"primary"},on:{click:e.submitModify}},[e._v("提交修改")])],1)],1)},m=[],f={props:{header:{type:Array,default:function(){return[]}},oldRecord:{type:Object,default:function(){return{}}}},data:function(){return{tableData:[],newRecord:{}}},mounted:function(){this.newRecord=Object.assign({},this.oldRecord),this.tableData.push(this.newRecord)},methods:{submitModify:function(){this.$emit("confirmModify",{newRecord:this.tableData[0],oldRecord:this.oldRecord})}}},b=f,p=(a("1230"),Object(i["a"])(b,h,m,!1,null,"0e1cc91f",null)),v=p.exports,g={components:{InsertFrame:d,EditFrame:v},data:function(){return{structure:[],tablename:"",header:[],tableData:[],total:0,showInsertFrame:!1,currentPage:1,showEditFrame:!1,currentRecord:{},showSqlFrame:!1,sql:"",downloadLoading:!1}},created:function(){var e=this,t=this.$route.query.dbname,a=this.$route.query.tablename;this.$http.get("/check/"+t+"/"+a).then(function(t){e.tablename=t.name,e.structure=t.infos}).catch(function(e){console.error(e)}),this.$http.post("/check/data",{dbname:this.$route.query.dbname,tablename:this.$route.query.tablename,offset:0}).then(function(t){e.total=t.total,e.header=t.header,e.tableData=t.data}).catch(function(e){console.error(e)})},methods:{changePage:function(e){var t=this;this.currentPage=e,this.$http.post("/check/data",{dbname:this.$route.query.dbname,tablename:this.$route.query.tablename,offset:10*(e-1)}).then(function(e){t.total=e.total,t.header=e.header,t.tableData=e.data}).catch(function(e){console.error(e)})},handleEdit:function(e){this.currentRecord=e,this.showEditFrame=!0},insertRecord:function(){this.showInsertFrame=!0},submitInsert:function(e){var t=this;e.map(function(e){delete e.index});var a=this.$route.query.dbname,n=this.$route.query.tablename;this.$http.post("/new/record",{dbname:a,tablename:n,records:e}).then(function(e){2e4===e.statusCode?(t.showInsertFrame=!1,t.$http.post("/check/data",{dbname:t.$route.query.dbname,tablename:t.$route.query.tablename,offset:0}).then(function(e){t.total=e.total,t.header=e.header,t.tableData=e.data}).catch(function(e){console.error(e)})):t.$message({showClose:!0,message:e.statusMsg,type:"error"})}).catch(function(e){console.error(e)})},handleDelete:function(e){var t=this;this.$http.post("/delete/record",{dbname:this.$route.query.dbname,tablename:this.$route.query.tablename,record:e}).then(function(e){2e4===e.statusCode?t.$http.post("/check/data",{dbname:t.$route.query.dbname,tablename:t.$route.query.tablename,offset:0}).then(function(e){e.total>10*(t.currentPage-1)?t.changePage(t.currentPage):1===t.currentPage?t.changePage(1):t.changePage(t.currentPage-1)}).catch(function(e){console.error(e)}):t.$message({showClose:!0,message:e.statusMsg,type:"error"})}).catch(function(e){console.error(e)})},submitModify:function(e){var t=this;this.$http.post("/update/record",{dbname:this.$route.query.dbname,tablename:this.$route.query.tablename,oldRecord:e.oldRecord,newRecord:e.newRecord}).then(function(e){2e4===e.statusCode?(t.showEditFrame=!1,t.changePage(t.currentPage)):t.$message({showClose:!0,message:e.statusMsg,type:"error"})}).catch(function(e){console.error(e)})},showSql:function(){var e=this,t=this.$route.query.dbname,a=this.$route.query.tablename;this.$http.get("/check/showsql/"+t+"/"+a).then(function(t){e.sql=t,e.showSqlFrame=!0}).catch(function(e){console.error(e)})},downloadToExcel:function(){var e=this;this.$http.post("/check/alldata",{dbname:this.$route.query.dbname,tablename:this.$route.query.tablename}).then(function(t){console.log(t),e.downloadLoading=!0,Promise.all([a.e("chunk-1d04694b"),a.e("chunk-2133cd4f")]).then(a.bind(null,"4bf8")).then(function(a){var n=t.header,r=t.header,o=t.data,l=e.formatJson(r,o);a.export_json_to_excel({header:n,data:l,filename:e.$route.query.tablename,autoWidth:!0,bookType:"xlsx"}),e.downloadLoading=!1})}).catch(function(e){console.error(e)})},formatJson:function(e,t){return t.map(function(t){return e.map(function(e){return"timestamp"===e?parseTime(t[e]):t[e]})})}}},y=g,w=(a("2a66"),Object(i["a"])(y,n,r,!1,null,"6d028bae",null));t["default"]=w.exports}}]);